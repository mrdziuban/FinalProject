var Attacklab=Attacklab||{};Attacklab.wmdBase=function(){var e=top.Attacklab;var t=top.document;var n=top.RegExp;var r=top.navigator;e.Util={};e.Position={};e.Command={};e.Global={};var i=e.Util;var s=e.Position;var o=e.Command;var u=e.Global;u.isIE=/msie/.test(r.userAgent.toLowerCase());u.isIE_5or6=/msie 6/.test(r.userAgent.toLowerCase())||/msie 5/.test(r.userAgent.toLowerCase());u.isIE_7plus=u.isIE&&!u.isIE_5or6;u.isOpera=/opera/.test(r.userAgent.toLowerCase());u.isKonqueror=/konqueror/.test(r.userAgent.toLowerCase());var a="<p style='margin-top: 0px'><b>Enter the image URL.</b></p><p>You can also add a title, which will be displayed as a tool tip.</p><p>Example:<br />http://wmd-editor.com/images/cloud1.jpg   \"Optional title\"</p>";var f="<p style='margin-top: 0px'><b>Enter the web address.</b></p><p>You can also add a title, which will be displayed as a tool tip.</p><p>Example:<br />http://wmd-editor.com/   \"Optional title\"</p>";var l="http://";var c="http://";var h="images/";var p=500;var d=100;var v="http://wmd-editor.com/";var m="WMD website";var g="_blank";e.PanelCollection=function(){this.buttonBar=t.getElementById("wmd-button-bar");this.preview=t.getElementById("wmd-preview");this.output=t.getElementById("wmd-output");this.input=t.getElementById("wmd-input")};e.panels=undefined;e.ieCachedRange=null;e.ieRetardedClick=false;i.isVisible=function(e){if(window.getComputedStyle){return window.getComputedStyle(e,null).getPropertyValue("display")!=="none"}else if(e.currentStyle){return e.currentStyle["display"]!=="none"}};i.addEvent=function(e,t,n){if(e.attachEvent){e.attachEvent("on"+t,n)}else{e.addEventListener(t,n,false)}};i.removeEvent=function(e,t,n){if(e.detachEvent){e.detachEvent("on"+t,n)}else{e.removeEventListener(t,n,false)}};i.fixEolChars=function(e){e=e.replace(/\r\n/g,"\n");e=e.replace(/\r/g,"\n");return e};i.extendRegExp=function(e,t,n){if(t===null||t===undefined){t=""}if(n===null||n===undefined){n=""}var r=e.toString();var i="";var s=r.match(/\/([gim]*)$/);if(s===null){i=s[0]}else{i=""}r=r.replace(/(^\/|\/[gim]*$)/g,"");r=t+r+n;return new RegExp(r,i)};i.createImage=function(e){var n=h+e;var r=t.createElement("img");r.className="wmd-button";r.src=n;return r};i.prompt=function(e,n,o){var a;var f;var l;if(n===undefined){n=""}var c=function(e){var t=e.charCode||e.keyCode;if(t===27){h(true)}};var h=function(e){i.removeEvent(t.body,"keydown",c);var n=l.value;if(e){n=null}else{n=n.replace("http://http://","http://");n=n.replace("http://https://","https://");n=n.replace("http://ftp://","ftp://");if(n.indexOf("http://")===-1&&n.indexOf("ftp://")===-1&&n.indexOf("https://")===-1){n="http://"+n}}a.parentNode.removeChild(a);f.parentNode.removeChild(f);o(n);return false};var p=function(){f=t.createElement("div");f.className="wmd-prompt-background";style=f.style;style.position="absolute";style.top="0";style.zIndex="5000";if(u.isKonqueror){style.backgroundColor="transparent"}else if(u.isIE){style.filter="alpha(opacity=50)"}else{style.opacity="0.5"}var e=s.getPageSize();style.height=e[1]+"px";if(u.isIE){style.left=t.documentElement.scrollLeft;style.width=t.documentElement.clientWidth}else{style.left="0";style.width="100%"}t.body.appendChild(f)};var d=function(){a=t.createElement("div");a.className="wmd-prompt-dialog";a.style.padding="10px;";a.style.position="fixed";a.style.width="400px";a.style.zIndex="5001";var o=t.createElement("div");o.innerHTML=e;o.style.padding="5px";a.appendChild(o);var f=t.createElement("form");f.onsubmit=function(){return h(false)};style=f.style;style.padding="0";style.margin="0";style.cssFloat="left";style.width="100%";style.textAlign="center";style.position="relative";a.appendChild(f);l=t.createElement("input");l.type="text";l.value=n;style=l.style;style.display="block";style.width="80%";style.marginLeft=style.marginRight="auto";f.appendChild(l);var p=t.createElement("input");p.type="button";p.onclick=function(){return h(false)};p.value="OK";style=p.style;style.margin="10px";style.display="inline";style.width="7em";var d=t.createElement("input");d.type="button";d.onclick=function(){return h(true)};d.value="Cancel";style=d.style;style.margin="10px";style.display="inline";style.width="7em";if(/mac/.test(r.platform.toLowerCase())){f.appendChild(d);f.appendChild(p)}else{f.appendChild(p);f.appendChild(d)}i.addEvent(t.body,"keydown",c);a.style.top="50%";a.style.left="50%";a.style.display="block";if(u.isIE_5or6){a.style.position="absolute";a.style.top=t.documentElement.scrollTop+200+"px";a.style.left="50%"}t.body.appendChild(a);a.style.marginTop=-(s.getHeight(a)/2)+"px";a.style.marginLeft=-(s.getWidth(a)/2)+"px"};p();top.setTimeout(function(){d();var e=n.length;if(l.selectionStart!==undefined){l.selectionStart=0;l.selectionEnd=e}else if(l.createTextRange){var t=l.createTextRange();t.collapse(false);t.moveStart("character",-e);t.moveEnd("character",e);t.select()}l.focus()},0)};s.getTop=function(e,t){var n=e.offsetTop;if(!t){while(e=e.offsetParent){n+=e.offsetTop}}return n};s.getHeight=function(e){return e.offsetHeight||e.scrollHeight};s.getWidth=function(e){return e.offsetWidth||e.scrollWidth};s.getPageSize=function(){var e,n;var r,i;if(self.innerHeight&&self.scrollMaxY){e=t.body.scrollWidth;n=self.innerHeight+self.scrollMaxY}else if(t.body.scrollHeight>t.body.offsetHeight){e=t.body.scrollWidth;n=t.body.scrollHeight}else{e=t.body.offsetWidth;n=t.body.offsetHeight}if(self.innerHeight){r=self.innerWidth;i=self.innerHeight}else if(t.documentElement&&t.documentElement.clientHeight){r=t.documentElement.clientWidth;i=t.documentElement.clientHeight}else if(t.body){r=t.body.clientWidth;i=t.body.clientHeight}var s=Math.max(e,r);var o=Math.max(n,i);return[s,o,r,i]};e.inputPoller=function(t,n){var r=this;var s=e.panels.input;var o;var u;var a;var f;this.tick=function(){if(!i.isVisible(s)){return}if(s.selectionStart||s.selectionStart===0){var e=s.selectionStart;var t=s.selectionEnd;if(e!=o||t!=u){o=e;u=t;if(a!=s.value){a=s.value;return true}}}return false};var l=function(){if(!i.isVisible(s)){return}if(r.tick()){t()}};var c=function(){f=top.setInterval(l,n)};this.destroy=function(){top.clearInterval(f)};c()};e.undoManager=function(t){var n=this;var r=[];var s=0;var o="none";var a;var f;var l;var c;var h=function(e,t){if(o!=e){o=e;if(!t){v()}}if(!u.isIE||o!="moving"){l=top.setTimeout(p,1)}else{c=null}};var p=function(){c=new e.TextareaState;f.tick();l=undefined};this.setCommandMode=function(){o="command";v();l=top.setTimeout(p,0)};this.canUndo=function(){return s>1};this.canRedo=function(){if(r[s+1]){return true}return false};this.undo=function(){if(n.canUndo()){if(a){a.restore();a=null}else{r[s]=new e.TextareaState;r[--s].restore();if(t){t()}}}o="none";e.panels.input.focus();p()};this.redo=function(){if(n.canRedo()){r[++s].restore();if(t){t()}}o="none";e.panels.input.focus();p()};var v=function(){var n=c||new e.TextareaState;if(!n){return false}if(o=="moving"){if(!a){a=n}return}if(a){if(r[s-1].text!=a.text){r[s++]=a}a=null}r[s++]=n;r[s+1]=null;if(t){t()}};var m=function(e){var t=false;if(e.ctrlKey||e.metaKey){var r=e.charCode||e.keyCode;var i=String.fromCharCode(r);switch(i){case"y":n.redo();t=true;break;case"z":if(!e.shiftKey){n.undo()}else{n.redo()}t=true;break}}if(t){if(e.preventDefault){e.preventDefault()}if(top.event){top.event.returnValue=false}return}};var g=function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.keyCode;if(t>=33&&t<=40||t>=63232&&t<=63235){h("moving")}else if(t==8||t==46||t==127){h("deleting")}else if(t==13){h("newlines")}else if(t==27){h("escape")}else if((t<16||t>20)&&t!=91){h("typing")}}};var y=function(){i.addEvent(e.panels.input,"keypress",function(e){if((e.ctrlKey||e.metaKey)&&(e.keyCode==89||e.keyCode==90)){e.preventDefault()}});var t=function(){if(u.isIE||c&&c.text!=e.panels.input.value){if(l==undefined){o="paste";v();p()}}};f=new e.inputPoller(t,d);i.addEvent(e.panels.input,"keydown",m);i.addEvent(e.panels.input,"keydown",g);i.addEvent(e.panels.input,"mousedown",function(){h("moving")});e.panels.input.onpaste=t;e.panels.input.ondrop=t};var b=function(){y();p();v()};this.destroy=function(){if(f){f.destroy()}};b()};e.editor=function(n){if(!n){n=function(){}}var s=e.panels.input;var a=0;var f=this;var l;var c;var h;var p;var d;var y=function(t){s.focus();if(t.textOp){if(d){d.setCommandMode()}var r=new e.TextareaState;if(!r){return}var i=r.getChunks();var o=function(){s.focus();if(i){r.setChunks(i)}r.restore();n()};var u=true;var a=t.textOp(i,o,u);if(!a){o()}}if(t.execute){t.execute(f)}};var b=function(){if(d){w(document.getElementById("wmd-undo-button"),d.canUndo());w(document.getElementById("wmd-redo-button"),d.canRedo())}};var w=function(t,n){var r="0px";var i="-20px";var s="-40px";if(n){t.style.backgroundPosition=t.XShift+" "+r;t.onmouseover=function(){this.style.backgroundPosition=this.XShift+" "+s};t.onmouseout=function(){this.style.backgroundPosition=this.XShift+" "+r};if(u.isIE){t.onmousedown=function(){e.ieRetardedClick=true;e.ieCachedRange=document.selection.createRange()}}if(!t.isHelp){t.onclick=function(){if(this.onmouseout){this.onmouseout()}y(this);return false}}}else{t.style.backgroundPosition=t.XShift+" "+i;t.onmouseover=t.onmouseout=t.onclick=function(){}}};var E=function(){var e=document.getElementById("wmd-button-bar");var t="0px";var n="-20px";var i="-40px";var s=document.createElement("ul");s.id="wmd-button-row";s=e.appendChild(s);var u=document.createElement("li");u.className="wmd-button";u.id="wmd-bold-button";u.title="Strong <strong> Ctrl+B";u.XShift="0px";u.textOp=o.doBold;w(u,true);s.appendChild(u);var a=document.createElement("li");a.className="wmd-button";a.id="wmd-italic-button";a.title="Emphasis <em> Ctrl+I";a.XShift="-20px";a.textOp=o.doItalic;w(a,true);s.appendChild(a);var f=document.createElement("li");f.className="wmd-spacer";f.id="wmd-spacer1";s.appendChild(f);var l=document.createElement("li");l.className="wmd-button";l.id="wmd-link-button";l.title="Hyperlink <a> Ctrl+L";l.XShift="-40px";l.textOp=function(e,t,n){return o.doLinkOrImage(e,t,false)};w(l,true);s.appendChild(l);var c=document.createElement("li");c.className="wmd-button";c.id="wmd-quote-button";c.title="Blockquote <blockquote> Ctrl+Q";c.XShift="-60px";c.textOp=o.doBlockquote;w(c,true);s.appendChild(c);var h=document.createElement("li");h.className="wmd-button";h.id="wmd-code-button";h.title="Code Sample <pre><code> Ctrl+K";h.XShift="-80px";h.textOp=o.doCode;w(h,true);s.appendChild(h);var p=document.createElement("li");p.className="wmd-button";p.id="wmd-image-button";p.title="Image <img> Ctrl+G";p.XShift="-100px";p.textOp=function(e,t,n){return o.doLinkOrImage(e,t,true)};w(p,true);s.appendChild(p);var d=document.createElement("li");d.className="wmd-spacer";d.id="wmd-spacer2";s.appendChild(d);var y=document.createElement("li");y.className="wmd-button";y.id="wmd-olist-button";y.title="Numbered List <ol> Ctrl+O";y.XShift="-120px";y.textOp=function(e,t,n){o.doList(e,t,true,n)};w(y,true);s.appendChild(y);var E=document.createElement("li");E.className="wmd-button";E.id="wmd-ulist-button";E.title="Bulleted List <ul> Ctrl+U";E.XShift="-140px";E.textOp=function(e,t,n){o.doList(e,t,false,n)};w(E,true);s.appendChild(E);var S=document.createElement("li");S.className="wmd-button";S.id="wmd-heading-button";S.title="Heading <h1>/<h2> Ctrl+H";S.XShift="-160px";S.textOp=o.doHeading;w(S,true);s.appendChild(S);var x=document.createElement("li");x.className="wmd-button";x.id="wmd-hr-button";x.title="Horizontal Rule <hr> Ctrl+R";x.XShift="-180px";x.textOp=o.doHorizontalRule;w(x,true);s.appendChild(x);var T=document.createElement("li");T.className="wmd-spacer";T.id="wmd-spacer3";s.appendChild(T);var N=document.createElement("li");N.className="wmd-button";N.id="wmd-undo-button";N.title="Undo - Ctrl+Z";N.XShift="-200px";N.execute=function(e){e.undo()};w(N,true);s.appendChild(N);var C=document.createElement("li");C.className="wmd-button";C.id="wmd-redo-button";C.title="Redo - Ctrl+Y";if(/win/.test(r.platform.toLowerCase())){C.title="Redo - Ctrl+Y"}else{C.title="Redo - Ctrl+Shift+Z"}C.XShift="-220px";C.execute=function(e){e.redo()};w(C,true);s.appendChild(C);var k=document.createElement("li");k.className="wmd-button";k.id="wmd-help-button";k.XShift="-240px";k.isHelp=true;var L=document.createElement("a");L.href=v;L.target=g;L.title=m;k.appendChild(L);w(k,true);s.appendChild(k);b()};var S=function(){if(/\?noundo/.test(t.location.href)){e.nativeUndo=true}if(!e.nativeUndo){d=new e.undoManager(function(){n();b()})}E();var r="keydown";if(u.isOpera){r="keypress"}i.addEvent(s,r,function(e){if(e.ctrlKey||e.metaKey){var t=e.charCode||e.keyCode;var n=String.fromCharCode(t).toLowerCase();switch(n){case"b":y(document.getElementById("wmd-bold-button"));break;case"i":y(document.getElementById("wmd-italic-button"));break;case"l":y(document.getElementById("wmd-link-button"));break;case"q":y(document.getElementById("wmd-quote-button"));break;case"k":y(document.getElementById("wmd-code-button"));break;case"g":y(document.getElementById("wmd-image-button"));break;case"o":y(document.getElementById("wmd-olist-button"));break;case"u":y(document.getElementById("wmd-ulist-button"));break;case"h":y(document.getElementById("wmd-heading-button"));break;case"r":y(document.getElementById("wmd-hr-button"));break;case"y":y(document.getElementById("wmd-redo-button"));break;case"z":if(e.shiftKey){y(document.getElementById("wmd-redo-button"))}else{y(document.getElementById("wmd-undo-button"))}break;default:return}if(e.preventDefault){e.preventDefault()}if(top.event){top.event.returnValue=false}}});i.addEvent(s,"keyup",function(e){if(!e.shiftKey&&!e.ctrlKey&&!e.metaKey){var t=e.charCode||e.keyCode;if(t===13){fakeButton={};fakeButton.textOp=o.doAutoindent;y(fakeButton)}}});if(u.isIE){i.addEvent(s,"keydown",function(e){var t=e.keyCode;if(t===27){return false}})}if(s.form){var a=s.form.onsubmit;s.form.onsubmit=function(){x();if(a){return a.apply(this,arguments)}}}};var x=function(){if(e.showdown){var t=new e.showdown.converter}var n=s.value;var r=function(){s.value=n};if(!/markdown/.test(e.wmd_env.output.toLowerCase())){if(t){s.value=t.makeHtml(n);top.setTimeout(r,0)}}return true};this.undo=function(){if(d){d.undo()}};this.redo=function(){if(d){d.redo()}};var T=function(){S()};this.destroy=function(){if(d){d.destroy()}if(h.parentNode){h.parentNode.removeChild(h)}if(s){s.style.marginTop=""}top.clearInterval(p)};T()};e.TextareaState=function(){var n=this;var r=e.panels.input;this.init=function(){if(!i.isVisible(r)){return}this.setInputAreaSelectionStartEnd();this.scrollTop=r.scrollTop;if(!this.text&&r.selectionStart||r.selectionStart===0){this.text=r.value}};this.setInputAreaSelection=function(){if(!i.isVisible(r)){return}if(r.selectionStart!==undefined&&!u.isOpera){r.focus();r.selectionStart=n.start;r.selectionEnd=n.end;r.scrollTop=n.scrollTop}else if(t.selection){if(t.activeElement&&t.activeElement!==r){return}r.focus();var e=r.createTextRange();e.moveStart("character",-r.value.length);e.moveEnd("character",-r.value.length);e.moveEnd("character",n.end);e.moveStart("character",n.start);e.select()}};this.setInputAreaSelectionStartEnd=function(){if(r.selectionStart||r.selectionStart===0){n.start=r.selectionStart;n.end=r.selectionEnd}else if(t.selection){n.text=i.fixEolChars(r.value);var s;if(e.ieRetardedClick&&e.ieCachedRange){s=e.ieCachedRange;e.ieRetardedClick=false}else{s=t.selection.createRange()}var o=i.fixEolChars(s.text);var u="";var a=u+o+u;s.text=a;var f=i.fixEolChars(r.value);s.moveStart("character",-a.length);s.text=o;n.start=f.indexOf(u);n.end=f.lastIndexOf(u)-u.length;var l=n.text.length-i.fixEolChars(r.value).length;if(l){s.moveStart("character",-o.length);while(l--){o+="\n";n.end+=1}s.text=o}this.setInputAreaSelection()}};this.restore=function(){if(n.text!=undefined&&n.text!=r.value){r.value=n.text}this.setInputAreaSelection();r.scrollTop=n.scrollTop};this.getChunks=function(){var t=new e.Chunks;t.before=i.fixEolChars(n.text.substring(0,n.start));t.startTag="";t.selection=i.fixEolChars(n.text.substring(n.start,n.end));t.endTag="";t.after=i.fixEolChars(n.text.substring(n.end));t.scrollTop=n.scrollTop;return t};this.setChunks=function(e){e.before=e.before+e.startTag;e.after=e.endTag+e.after;if(u.isOpera){e.before=e.before.replace(/\n/g,"\r\n");e.selection=e.selection.replace(/\n/g,"\r\n");e.after=e.after.replace(/\n/g,"\r\n")}this.start=e.before.length;this.end=e.before.length+e.selection.length;this.text=e.before+e.selection+e.after;this.scrollTop=e.scrollTop};this.init()};e.Chunks=function(){};e.Chunks.prototype.findTags=function(e,t){var n=this;var r;if(e){r=i.extendRegExp(e,"","$");this.before=this.before.replace(r,function(e){n.startTag=n.startTag+e;return""});r=i.extendRegExp(e,"^","");this.selection=this.selection.replace(r,function(e){n.startTag=n.startTag+e;return""})}if(t){r=i.extendRegExp(t,"","$");this.selection=this.selection.replace(r,function(e){n.endTag=e+n.endTag;return""});r=i.extendRegExp(t,"^","");this.after=this.after.replace(r,function(e){n.endTag=e+n.endTag;return""})}};e.Chunks.prototype.trimWhitespace=function(e){this.selection=this.selection.replace(/^(\s*)/,"");if(!e){this.before+=n.$1}this.selection=this.selection.replace(/(\s*)$/,"");if(!e){this.after=n.$1+this.after}};e.Chunks.prototype.addBlankLines=function(e,t,r){if(e===undefined){e=1}if(t===undefined){t=1}e++;t++;var i;var s;this.selection=this.selection.replace(/(^\n*)/,"");this.startTag=this.startTag+n.$1;this.selection=this.selection.replace(/(\n*$)/,"");this.endTag=this.endTag+n.$1;this.startTag=this.startTag.replace(/(^\n*)/,"");this.before=this.before+n.$1;this.endTag=this.endTag.replace(/(\n*$)/,"");this.after=this.after+n.$1;if(this.before){i=s="";while(e--){i+="\\n?";s+="\n"}if(r){i="\\n*"}this.before=this.before.replace(new n(i+"$",""),s)}if(this.after){i=s="";while(t--){i+="\\n?";s+="\n"}if(r){i="\\n*"}this.after=this.after.replace(new n(i,""),s)}};o.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)";o.unwrap=function(e){var t=new n("([^\\n])\\n(?!(\\n|"+o.prefixes+"))","g");e.selection=e.selection.replace(t,"$1 $2")};o.wrap=function(e,t){o.unwrap(e);var r=new n("(.{1,"+t+"})( +|$\\n?)","gm");e.selection=e.selection.replace(r,function(e,t){if((new n("^"+o.prefixes,"")).test(e)){return e}return t+"\n"});e.selection=e.selection.replace(/\s+$/,"")};o.doBold=function(e,t,n){return o.doBorI(e,2,"strong text")};o.doItalic=function(e,t,n){return o.doBorI(e,1,"emphasized text")};o.doBorI=function(e,t,r){e.trimWhitespace();e.selection=e.selection.replace(/\n{2,}/g,"\n");e.before.search(/(\**$)/);var i=n.$1;e.after.search(/(^\**)/);var s=n.$1;var o=Math.min(i.length,s.length);if(o>=t&&(o!=2||t!=1)){e.before=e.before.replace(n("[*]{"+t+"}$",""),"");e.after=e.after.replace(n("^[*]{"+t+"}",""),"")}else if(!e.selection&&s){e.after=e.after.replace(/^([*_]*)/,"");e.before=e.before.replace(/(\s?)$/,"");var u=n.$1;e.before=e.before+s+u}else{if(!e.selection&&!s){e.selection=r}var a=t<=1?"*":"**";e.before=e.before+a;e.after=a+e.after}return};o.stripLinkDefs=function(e,t){e=e.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(e,n,r,i,s){t[n]=e.replace(/\s*$/,"");if(i){t[n]=e.replace(/["(](.+?)[")]$/,"");return i+s}return""});return e};o.addLinkDef=function(e,t){var n=0;var r={};e.before=o.stripLinkDefs(e.before,r);e.selection=o.stripLinkDefs(e.selection,r);e.after=o.stripLinkDefs(e.after,r);var i="";var s=/(\[(?:\[[^\]]*\]|[^\[\]])*\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g;var u=function(e){n++;e=e.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+n+"]:");i+="\n"+e};var a=function(e,t,i,s){if(r[i]){u(r[i]);return t+n+s}return e};e.before=e.before.replace(s,a);if(t){u(t)}else{e.selection=e.selection.replace(s,a)}var f=n;e.after=e.after.replace(s,a);if(e.after){e.after=e.after.replace(/\n*$/,"")}if(!e.after){e.selection=e.selection.replace(/\n*$/,"")}e.after+="\n\n"+i;return f};o.doLinkOrImage=function(e,t,n){e.trimWhitespace();e.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);if(e.endTag.length>1){e.startTag=e.startTag.replace(/!?\[/,"");e.endTag="";o.addLinkDef(e,null)}else{if(/\n\n/.test(e.selection)){o.addLinkDef(e,null);return}var r=function(r){if(r!==null){e.startTag=e.endTag="";var i=" [999]: "+r;var s=o.addLinkDef(e,i);e.startTag=n?"![":"[";e.endTag="]["+s+"]";if(!e.selection){if(n){e.selection="alt text"}else{e.selection="link text"}}}t()};if(n){i.prompt(a,l,r)}else{i.prompt(f,c,r)}return true}};i.makeAPI=function(){e.wmd={};e.wmd.editor=e.editor;e.wmd.previewManager=e.previewManager};i.startEditor=function(){if(e.wmd_env.autostart===false){i.makeAPI();return}var t;var n;var r=function(){e.panels=new e.PanelCollection;n=new e.previewManager;var r=n.refresh;t=new e.editor(r);n.refresh(true)};i.addEvent(top,"load",r)};e.previewManager=function(){var n=this;var r;var o;var a;var f;var l;var c;var h=3e3;var d="delayed";var v=function(t,n){i.addEvent(t,"input",n);t.onpaste=n;t.ondrop=n;i.addEvent(t,"keypress",n);i.addEvent(t,"keydown",n);o=new e.inputPoller(n,p)};var m=function(){var e=0;if(top.innerHeight){e=top.pageYOffset}else if(t.documentElement&&t.documentElement.scrollTop){e=t.documentElement.scrollTop}else if(t.body){e=t.body.scrollTop}return e};var g=function(){if(!e.panels.preview&&!e.panels.output){return}var t=e.panels.input.value;if(t&&t==l){return}else{l=t}var n=(new Date).getTime();if(!r&&e.showdown){r=new e.showdown.converter}if(r){t=r.makeHtml(t)}var i=(new Date).getTime();f=i-n;S(t);c=t};var y=function(){if(a){top.clearTimeout(a);a=undefined}if(d!=="manual"){var e=0;if(d==="delayed"){e=f}if(e>h){e=h}a=top.setTimeout(g,e)}};var b=function(e){if(e.scrollHeight<=e.clientHeight){return 1}return e.scrollTop/(e.scrollHeight-e.clientHeight)};var w=function(){if(e.panels.preview){e.panels.preview.scrollTop=(e.panels.preview.scrollHeight-e.panels.preview.clientHeight)*b(e.panels.preview);}if(e.panels.output){e.panels.output.scrollTop=(e.panels.output.scrollHeight-e.panels.output.clientHeight)*b(e.panels.output);}};this.refresh=function(e){if(e){l="";g()}else{y()}};this.processingTime=function(){return f};this.output=function(){return c};this.setUpdateMode=function(e){d=e;n.refresh()};var E=true;var S=function(t){var n=s.getTop(e.panels.input)-m();if(e.panels.output){if(e.panels.output.value!==undefined){e.panels.output.value=t;e.panels.output.readOnly=true}else{var r=t.replace(/&/g,"&");r=r.replace(/</g,"<");e.panels.output.innerHTML="<pre><code>"+r+"</code></pre>"}}if(e.panels.preview){e.panels.preview.innerHTML=t}w();if(E){E=false;return}var i=s.getTop(e.panels.input)-m();if(u.isIE){top.setTimeout(function(){top.scrollBy(0,i-n)},0)}else{top.scrollBy(0,i-n)}};var x=function(){v(e.panels.input,y);g();if(e.panels.preview){e.panels.preview.scrollTop=0}if(e.panels.output){e.panels.output.scrollTop=0}};this.destroy=function(){if(o){o.destroy()}};x()};o.doAutoindent=function(e,t,n){e.before=e.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n");e.before=e.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n");e.before=e.before.replace(/(\n|^)[ \t]+\n$/,"\n\n");n=false;if(/(\n|^)[ ]{0,3}([*+-])[ \t]+.*\n$/.test(e.before)){if(o.doList){o.doList(e,t,false,true)}}if(/(\n|^)[ ]{0,3}(\d+[.])[ \t]+.*\n$/.test(e.before)){if(o.doList){o.doList(e,t,true,true)}}if(/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(e.before)){if(o.doBlockquote){o.doBlockquote(e,t,n)}}if(/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)){if(o.doCode){o.doCode(e,t,n)}}};o.doBlockquote=function(t,n,r){t.selection=t.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(e,n,r,i){t.before+=n;t.after=i+t.after;return r});t.before=t.before.replace(/(>[ \t]*)$/,function(e,n){t.selection=n+t.selection;return""});var i=r?"Blockquote":"";t.selection=t.selection.replace(/^(\s|>)+$/,"");t.selection=t.selection||i;if(t.before){t.before=t.before.replace(/\n?$/,"\n")}if(t.after){t.after=t.after.replace(/^\n?/,"\n")}t.before=t.before.replace(/(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*$)/,function(e){t.startTag=e;return""});t.after=t.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(e){t.endTag=e;return""});var s=function(e){var n=e?"> ":"";if(t.startTag){t.startTag=t.startTag.replace(/\n((>|\s)*)\n$/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"})}if(t.endTag){t.endTag=t.endTag.replace(/^\n((>|\s)*)\n/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"})}};if(/^(?![ ]{0,3}>)/m.test(t.selection)){o.wrap(t,e.wmd_env.lineLength-2);t.selection=t.selection.replace(/^/gm,"> ");s(true);t.addBlankLines()}else{t.selection=t.selection.replace(/^[ ]{0,3}> ?/gm,"");o.unwrap(t);s(false);if(!/^(\n|^)[ ]{0,3}>/.test(t.selection)&&t.startTag){t.startTag=t.startTag.replace(/\n{0,2}$/,"\n\n")}if(!/(\n|^)[ ]{0,3}>.*$/.test(t.selection)&&t.endTag){t.endTag=t.endTag.replace(/^\n{0,2}/,"\n\n")}}if(!/\n/.test(t.selection)){t.selection=t.selection.replace(/^(> *)/,function(e,n){t.startTag+=n;return""})}};o.doCode=function(e,t,n){var r=/\S[ ]*$/.test(e.before);var i=/^[ ]*\S/.test(e.after);if(!i&&!r||/\n/.test(e.selection)){e.before=e.before.replace(/[ ]{4}$/,function(t){e.selection=t+e.selection;return""});var s=1;var o=1;if(/\n(\t|[ ]{4,}).*\n$/.test(e.before)||e.after===""){s=0}if(/^\n(\t|[ ]{4,})/.test(e.after)){o=0}e.addBlankLines(s,o);if(!e.selection){e.startTag="    ";e.selection=n?"enter code here":""}else{if(/^[ ]{0,3}\S/m.test(e.selection)){e.selection=e.selection.replace(/^/gm,"    ")}else{e.selection=e.selection.replace(/^[ ]{4}/gm,"")}}}else{e.trimWhitespace();e.findTags(/`/,/`/);if(!e.startTag&&!e.endTag){e.startTag=e.endTag="`";if(!e.selection){e.selection=n?"enter code here":""}}else if(e.endTag&&!e.startTag){e.before+=e.endTag;e.endTag=""}else{e.startTag=e.endTag=""}}};o.doList=function(t,r,i,s){var u=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/;var a=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/;var f="-";var l=1;var c=function(){var e;if(i){e=" "+l+". ";l++}else{e=" "+f+" "}return e};var h=function(e){if(i===undefined){i=/^\s*\d/.test(e)}e=e.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(e){return c()});return e};t.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null);if(t.before&&!/\n$/.test(t.before)&&!/^\n/.test(t.startTag)){t.before+=t.startTag;t.startTag=""}if(t.startTag){var p=/\d+[.]/.test(t.startTag);t.startTag="";t.selection=t.selection.replace(/\n[ ]{4}/g,"\n");o.unwrap(t);t.addBlankLines();if(p){t.after=t.after.replace(a,h)}if(i==p){return}}var d=1;t.before=t.before.replace(u,function(e){if(/^\s*([*+-])/.test(e)){f=n.$1}d=/[^\n]\n\n[^\n]/.test(e)?1:0;return h(e)});if(!t.selection){t.selection=s?"List item":" "}var v=c();var m=1;t.after=t.after.replace(a,function(e){m=/[^\n]\n\n[^\n]/.test(e)?1:0;return h(e)});t.trimWhitespace(true);t.addBlankLines(d,m,true);t.startTag=v;var g=v.replace(/./g," ");o.wrap(t,e.wmd_env.lineLength-g.length);t.selection=t.selection.replace(/\n/g,"\n"+g)};o.doHeading=function(t,r,i){t.selection=t.selection.replace(/\s+/g," ");t.selection=t.selection.replace(/(^\s+|\s+$)/g,"");if(!t.selection){t.startTag="## ";t.selection="Heading";t.endTag=" ##";return}var s=0;t.findTags(/#+[ ]*/,/[ ]*#+/);if(/#+/.test(t.startTag)){s=n.lastMatch.length}t.startTag=t.endTag="";t.findTags(null,/\s?(-+|=+)/);if(/=+/.test(t.endTag)){s=1}if(/-+/.test(t.endTag)){s=2}t.startTag=t.endTag="";t.addBlankLines(1,1);var o=s==0?2:s-1;if(o>0){var u=o>=2?"-":"=";var a=t.selection.length;if(a>e.wmd_env.lineLength){a=e.wmd_env.lineLength}t.endTag="\n";while(a--){t.endTag+=u}}};o.doHorizontalRule=function(e,t,n){e.startTag="----------\n";e.selection="";e.addBlankLines(2,1,true)}};Attacklab.wmd_env={};Attacklab.account_options={};Attacklab.wmd_defaults={version:1,output:"HTML",lineLength:40,delayLoad:false};if(!Attacklab.wmd){Attacklab.wmd=function(){Attacklab.loadEnv=function(){var e=function(e){if(!e){return}for(var t in e){Attacklab.wmd_env[t]=e[t]}};e(Attacklab.wmd_defaults);e(Attacklab.account_options);e(top["wmd_options"]);Attacklab.full=true;var t="bold italic link blockquote code image ol ul heading hr";Attacklab.wmd_env.buttons=Attacklab.wmd_env.buttons||t};Attacklab.loadEnv()};Attacklab.wmd();Attacklab.wmdBase();Attacklab.Util.startEditor()}